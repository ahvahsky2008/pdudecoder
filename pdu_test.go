package pdudecoder_test

import (
	"encoding/hex"
	"fmt"
	"log"
	"testing"

	"github.com/vinhjaxt/pdudecoder"
)

func dumpMsg(msg *pdudecoder.Message) {
	fmt.Println("Type:", msg.Type)
	fmt.Println("SMSC:", msg.SMSC)
	fmt.Println("Address:", msg.Address)
	fmt.Println("ServiceCenterTime:", msg.ServiceCenterTime)
	fmt.Println("Text:", msg.Text)
	fmt.Println("ValidityPeriod:", msg.ValidityPeriod)
	fmt.Println("PartNumber:", msg.PartNumber)
	fmt.Println("TotalParts:", msg.TotalParts)
	fmt.Printf("\r\n\r\n")
}

var pdus = []string{
	`07911326040000F0040B911346610089F60000208062917314080CC8F71D14969741F977FD07`,
	`07917283010010F5040BC87238880900F10000993092516195800AE8329BFD4697D9EC37`,
	`0011000B916407281553F80000AA0AE8329BFD4697D9EC37`,
	`0001000B915121551532F400000CC8F79D9C07E54F61363B04`,
	`0001010B915121551532F40010104190991D9EA341EDF27C1E3E9743`,
	`0041000B915121551532F40000A0050003000301986F79B90D4AC3E7F53688FC66BFE5A0799A0E0AB7CB741668FC76CFCB637A995E9783C2E4343C3D4F8FD3EE33A8CC4ED359A079990C22BF41E5747DDE7E9341F4721BFE9683D2EE719A9C26D7DD74509D0E6287C56F791954A683C86FF65B5E06B5C36777181466A7E3F5B0AB4A0795DDE936284C06B5D3EE741B642FBBD3E1360B14AFA7E7`,
	`0041010B915121551532F40000A005000300030240EEF79C2EAF9341657C593E4ED3C3F4F4DB0DAAB3D9E1F6F80D6287C56F797A0E72A7E769509D0E0AB3D3F17A1A0E2AE341E53068FC6EB7DFE43768FC76CFCBF17A98EE22D6D37350B84E2F83D2F2BABC0C22BFD96F3928ED06C9CB7079195D7693CBF2341D947683EC6F761D4E0FD3CB207B999DA683CAF37919344EB3D9F53688FC66BFE5`,
	`0041020B915121551532F4000090050003000303CAA0721D64AE9FD3613AC85D67B3C32078589E0ED3EB7257113F2EC3E9E5BA1C344FBBE9A0F7781C2E8FC374D0B80E4F93C3F4301DE47EBB4170F93B4D2EBBE92CD0BCEEA683D26ED0B8CE868741F17A1AF4369BD3E37418442ECFCBF2BA9B0E6ABFD9EC341D1476A7DBA03419549ED341ECB0F82DAFB75D`,
	`0041000B915121551532F400042E0B05040B84C0020003F001010A060403B081EA02066A008509036D6F62696C65746964696E67732E636F6D2F0001`,
	`0041000B915121551532F400045E0B05040B84C0020003F001010B060403AE81EA02056A0045C60C036D6F62696C65746964696E67732E636F6D2F000AC30620090226162510C3062009030416250103436865636B206F7574204D6F62696C6520546964696E677321000101`,
	`0041000B915121551532F40000631A0A031906200A032104100A032705040A032E05080A043807002B8ACD29A85D9ECFC3E7F21C340EBB41E3B79B1E4EBB41697A989D1EB340E2379BCC02B1C3F27399059AB7C36C3628EC2683C66FF65B5E2683E8653C1D`,
	`0001AB0B915121551532F400C80F3190BB7C07D9DFE971B91D4EB301`,
	`07915892000000F0040B915892214365F700007040213252242331493A283D0795C3F33C88FE06C9CB6132885EC6D341EDF27C1E3E97E7207B3A0C0A5241E377BB1D7693E72E`,
	`07914889200030F0110003A171F00000AA044BEA7406`,
	`07914889200016F40406D0B11B0C00009120221051008249D17A1EB44687C768D0185D0F83C861F719B4CE83E67510B9EE3E83CEEF34685A7381ACF53488FD769F41EB74B90DA2CBC3207638ED0261D36ED038DC06BDDD21`,
	`07914889200009F50406D0B11B0C00009120221041658249D17A1EB44687C768D0185D0F83C861F719B4CE83E67510B9EE3E83CEEF34683A7381ACF53488FD769F41EB74B90DA2CBC3207638ED0261D36ED038DC06BDDD21`,
}

func TestDecoder(t *testing.T) {
	for _, pdu := range pdus {
		bs, err := hex.DecodeString(pdu)
		if err != nil {
			log.Println(err)
			t.Fatal(1)
		}
		msg, err := pdudecoder.Decode(bs)
		if err != nil {
			log.Println(err)
			t.Fatal(1)
		}

		dumpMsg(msg)
	}
	t.Fatal(1)
}
